{"ast":null,"code":"import { fromBase64url, toBase64url } from './utils.js';\nexport function fromSplit(split) {\n  const [protectedHeader, encrypted_key, iv, ciphertext, tag] = split;\n  const jwe = {\n    ciphertext,\n    iv,\n    protected: protectedHeader,\n    tag\n  };\n  if (encrypted_key) jwe.recipients = [{\n    encrypted_key\n  }];\n  return jwe;\n}\n\nfunction encodeRecipient(recipient) {\n  const encRec = {};\n  if (recipient.encrypted_key) encRec.encrypted_key = fromBase64url(recipient.encrypted_key);\n  if (recipient.header) encRec.header = recipient.header;\n  return encRec;\n}\n\nexport function encode(jwe) {\n  const encJwe = {\n    ciphertext: fromBase64url(jwe.ciphertext),\n    protected: fromBase64url(jwe.protected),\n    iv: fromBase64url(jwe.iv),\n    tag: fromBase64url(jwe.tag)\n  };\n  if (jwe.aad) encJwe.aad = fromBase64url(jwe.aad);\n  if (jwe.recipients) encJwe.recipients = jwe.recipients.map(encodeRecipient);\n  if (jwe.unprotected) encJwe.unprotected = jwe.unprotected;\n  return encJwe;\n}\n\nfunction decodeRecipient(encoded) {\n  const recipient = {};\n  if (encoded.encrypted_key) recipient.encrypted_key = toBase64url(encoded.encrypted_key);\n  if (encoded.header) recipient.header = encoded.header;\n  return recipient;\n}\n\nexport function decode(encoded) {\n  const jwe = {\n    ciphertext: toBase64url(encoded.ciphertext),\n    protected: toBase64url(encoded.protected),\n    iv: toBase64url(encoded.iv),\n    tag: toBase64url(encoded.tag)\n  };\n  if (encoded.aad) jwe.aad = toBase64url(encoded.aad);\n  if (encoded.recipients) jwe.recipients = encoded.recipients.map(decodeRecipient);\n  if (encoded.unprotected) jwe.unprotected = encoded.unprotected;\n  return jwe;\n}","map":{"version":3,"mappings":"AAAA,SAASA,aAAT,EAAwBC,WAAxB,QAA2C,YAA3C;AAgCA,OAAM,SAAUC,SAAV,CAAoBC,KAApB,EAAwC;AAC5C,QAAM,CAACC,eAAD,EAAkBC,aAAlB,EAAiCC,EAAjC,EAAqCC,UAArC,EAAiDC,GAAjD,IAAwDL,KAA9D;AACA,QAAMM,GAAG,GAAW;AAClBF,cADkB;AAElBD,MAFkB;AAGlBI,aAAS,EAAEN,eAHO;AAIlBI;AAJkB,GAApB;AAMA,MAAIH,aAAJ,EAAmBI,GAAG,CAACE,UAAJ,GAAiB,CAAC;AAAEN;AAAF,GAAD,CAAjB;AACnB,SAAOI,GAAP;AACD;;AAED,SAASG,eAAT,CAAyBC,SAAzB,EAAgD;AAC9C,QAAMC,MAAM,GAAqB,EAAjC;AACA,MAAID,SAAS,CAACR,aAAd,EAA6BS,MAAM,CAACT,aAAP,GAAuBL,aAAa,CAACa,SAAS,CAACR,aAAX,CAApC;AAC7B,MAAIQ,SAAS,CAACE,MAAd,EAAsBD,MAAM,CAACC,MAAP,GAAgBF,SAAS,CAACE,MAA1B;AACtB,SAAOD,MAAP;AACD;;AAED,OAAM,SAAUE,MAAV,CAAiBP,GAAjB,EAA4B;AAChC,QAAMQ,MAAM,GAAe;AACzBV,cAAU,EAAEP,aAAa,CAACS,GAAG,CAACF,UAAL,CADA;AAEzBG,aAAS,EAAEV,aAAa,CAACS,GAAG,CAACC,SAAL,CAFC;AAGzBJ,MAAE,EAAEN,aAAa,CAACS,GAAG,CAACH,EAAL,CAHQ;AAIzBE,OAAG,EAAER,aAAa,CAACS,GAAG,CAACD,GAAL;AAJO,GAA3B;AAMA,MAAIC,GAAG,CAACS,GAAR,EAAaD,MAAM,CAACC,GAAP,GAAalB,aAAa,CAACS,GAAG,CAACS,GAAL,CAA1B;AACb,MAAIT,GAAG,CAACE,UAAR,EAAoBM,MAAM,CAACN,UAAP,GAAoBF,GAAG,CAACE,UAAJ,CAAeQ,GAAf,CAAmBP,eAAnB,CAApB;AACpB,MAAIH,GAAG,CAACW,WAAR,EAAqBH,MAAM,CAACG,WAAP,GAAqBX,GAAG,CAACW,WAAzB;AACrB,SAAOH,MAAP;AACD;;AAED,SAASI,eAAT,CAAyBC,OAAzB,EAAkD;AAChD,QAAMT,SAAS,GAAiB,EAAhC;AACA,MAAIS,OAAO,CAACjB,aAAZ,EAA2BQ,SAAS,CAACR,aAAV,GAA0BJ,WAAW,CAACqB,OAAO,CAACjB,aAAT,CAArC;AAC3B,MAAIiB,OAAO,CAACP,MAAZ,EAAoBF,SAAS,CAACE,MAAV,GAAmBO,OAAO,CAACP,MAA3B;AACpB,SAAOF,SAAP;AACD;;AAED,OAAM,SAAUU,MAAV,CAAiBD,OAAjB,EAAoC;AACxC,QAAMb,GAAG,GAAW;AAClBF,cAAU,EAAEN,WAAW,CAACqB,OAAO,CAACf,UAAT,CADL;AAElBG,aAAS,EAAET,WAAW,CAACqB,OAAO,CAACZ,SAAT,CAFJ;AAGlBJ,MAAE,EAAEL,WAAW,CAACqB,OAAO,CAAChB,EAAT,CAHG;AAIlBE,OAAG,EAAEP,WAAW,CAACqB,OAAO,CAACd,GAAT;AAJE,GAApB;AAMA,MAAIc,OAAO,CAACJ,GAAZ,EAAiBT,GAAG,CAACS,GAAJ,GAAUjB,WAAW,CAACqB,OAAO,CAACJ,GAAT,CAArB;AACjB,MAAII,OAAO,CAACX,UAAZ,EAAwBF,GAAG,CAACE,UAAJ,GAAiBW,OAAO,CAACX,UAAR,CAAmBQ,GAAnB,CAAuBE,eAAvB,CAAjB;AACxB,MAAIC,OAAO,CAACF,WAAZ,EAAyBX,GAAG,CAACW,WAAJ,GAAkBE,OAAO,CAACF,WAA1B;AACzB,SAAOX,GAAP;AACD","names":["fromBase64url","toBase64url","fromSplit","split","protectedHeader","encrypted_key","iv","ciphertext","tag","jwe","protected","recipients","encodeRecipient","recipient","encRec","header","encode","encJwe","aad","map","unprotected","decodeRecipient","encoded","decode"],"sources":["../src/encryption.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}